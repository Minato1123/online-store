import{g as i,a as u,k as e,s as b,u as V,l as E,h as at,d as ct,m as D,j as ot,n as st,r as $,o as nt,c as M,J as I,b as n,p as h,F as it,x as ut,t as l,q as dt,O as U,A as lt,B as rt,D as _t,C as ht,H as z,M as H,K as R,N as O,R as mt,_ as vt}from"./index.2e401dab.js";import{_ as pt,a as Ct}from"./check-box-outline.731cab50.js";import{I as ft}from"./shopping-basket-line.3e450d97.js";import{g as gt}from"./getProductListFromShoppingCartByUserId.c011d6c8.js";import{d as j}from"./deleteProductFromCart.dd467e27.js";const kt={class:"svg-icon",viewBox:"0 0 16 16",width:"1.2em",height:"1.2em"},It=e("g",{fill:"currentColor"},[e("path",{d:"M7.354 5.646a.5.5 0 1 0-.708.708L7.793 7.5L6.646 8.646a.5.5 0 1 0 .708.708L8.5 8.207l1.146 1.147a.5.5 0 0 0 .708-.708L9.207 7.5l1.147-1.146a.5.5 0 0 0-.708-.708L8.5 6.793L7.354 5.646z"}),e("path",{d:"M.5 1a.5.5 0 0 0 0 1h1.11l.401 1.607l1.498 7.985A.5.5 0 0 0 4 12h1a2 2 0 1 0 0 4a2 2 0 0 0 0-4h7a2 2 0 1 0 0 4a2 2 0 0 0 0-4h1a.5.5 0 0 0 .491-.408l1.5-8A.5.5 0 0 0 14.5 3H2.89l-.405-1.621A.5.5 0 0 0 2 1H.5zm3.915 10L3.102 4h10.796l-1.313 7h-8.17zM6 14a1 1 0 1 1-2 0a1 1 0 0 1 2 0zm7 0a1 1 0 1 1-2 0a1 1 0 0 1 2 0z"})],-1),bt=[It];function yt(m,p){return i(),u("svg",kt,bt)}const wt={name:"bi-cart-x",render:yt},xt={class:"svg-icon",viewBox:"0 0 512 512",width:"1.2em",height:"1.2em"},Ft=e("path",{fill:"currentColor",d:"m511.1 378.8l-26.7-160c-2.6-15.4-15.9-26.7-31.6-26.7H208v-64h96c8.8 0 16-7.2 16-16V16c0-8.8-7.2-16-16-16H48c-8.8 0-16 7.2-16 16v96c0 8.8 7.2 16 16 16h96v64H59.1c-15.6 0-29 11.3-31.6 26.7L.8 378.7c-.6 3.5-.9 7-.9 10.5V480c0 17.7 14.3 32 32 32h448c17.7 0 32-14.3 32-32v-90.7c.1-3.5-.2-7-.8-10.5zM280 248c0-8.8 7.2-16 16-16h16c8.8 0 16 7.2 16 16v16c0 8.8-7.2 16-16 16h-16c-8.8 0-16-7.2-16-16v-16zm-32 64h16c8.8 0 16 7.2 16 16v16c0 8.8-7.2 16-16 16h-16c-8.8 0-16-7.2-16-16v-16c0-8.8 7.2-16 16-16zm-32-80c8.8 0 16 7.2 16 16v16c0 8.8-7.2 16-16 16h-16c-8.8 0-16-7.2-16-16v-16c0-8.8 7.2-16 16-16h16zM80 80V48h192v32H80zm40 200h-16c-8.8 0-16-7.2-16-16v-16c0-8.8 7.2-16 16-16h16c8.8 0 16 7.2 16 16v16c0 8.8-7.2 16-16 16zm16 64v-16c0-8.8 7.2-16 16-16h16c8.8 0 16 7.2 16 16v16c0 8.8-7.2 16-16 16h-16c-8.8 0-16-7.2-16-16zm216 112c0 4.4-3.6 8-8 8H168c-4.4 0-8-3.6-8-8v-16c0-4.4 3.6-8 8-8h176c4.4 0 8 3.6 8 8v16zm24-112c0 8.8-7.2 16-16 16h-16c-8.8 0-16-7.2-16-16v-16c0-8.8 7.2-16 16-16h16c8.8 0 16 7.2 16 16v16zm48-80c0 8.8-7.2 16-16 16h-16c-8.8 0-16-7.2-16-16v-16c0-8.8 7.2-16 16-16h16c8.8 0 16 7.2 16 16v16z"},null,-1),Lt=[Ft];function At(m,p){return i(),u("svg",xt,Lt)}const $t={name:"fa-solid-cash-register",render:At};function zt(m){const{isMocked:p,mockData:y}=b(V()),{isUserTokenValid:C}=V(),{userToken:w}=b(E()),{forcedLogout:x}=E();if(!p.value)return at.patch({url:`/cartItems/${m.id}`,data:m});if(C(w.value)===!1){x();return}if(y.value==null)return;const r=y.value.cartItems;r.find(f=>f.id===m.id).amount=m.amount}const Et={class:"cart-container"},Pt={class:"cart-title"},Bt=["disabled"],St={class:"cart-bar"},Nt={class:"bar-all-product"},Tt=lt('<div class="bar-else" data-v-7a00558d> \u898F\u683C </div><div class="bar-else" data-v-7a00558d> \u55AE\u50F9 </div><div class="bar-else" data-v-7a00558d> \u6578\u91CF </div><div class="bar-else" data-v-7a00558d> \u5C0F\u8A08 </div><div class="bar-else" data-v-7a00558d> \u522A\u9664 </div>',5),Vt={key:0,class:"cart-content"},Dt={class:"product-checkbox"},Mt=["onClick"],Ut=["onClick"],Ht=["onClick"],Rt=["src"],Ot={class:"product-spec product-else"},jt={class:"product-price product-else"},qt={class:"product-amount product-else"},Gt=["onUpdate:modelValue","onClick"],Jt={class:"product-total product-else"},Kt={class:"product-rwd"},Qt=["src","onClick"],Wt={class:"product-rwd-else"},Xt=["onUpdate:modelValue","onClick"],Yt={class:"product-total"},Zt={class:"product-delete"},te=["onClick"],ee={key:1,class:"cart-no-content"},ae={class:"checkout-container"},ce={class:"checkout-total"},oe={class:"checkout-btns"},se=ct({__name:"Cart",setup(m){const{updateAmountOfProductInLocalCart:p,deleteAllLocalCart:y,removeProductInLocalCart:C}=D(),{cartList:w}=b(D()),{userId:x,isLoggedIn:r}=b(E()),{startLoading:f,endLoading:P}=ot(),{emit:F}=st(),B=$();async function g(){r.value&&(f(),B.value=(await gt({userId:x.value})).data,P())}const _=$([]);async function k(){var a,c;r.value?(f(),_.value=await Promise.all(((a=B.value)!=null?a:[]).map(async o=>{var s,T;const v=(await rt({id:o.productId})).data,A=(await _t({productId:o.productId})).data,t=(await ht({productId:o.productId})).data;return{id:o.id,productId:o.productId,categoryId:v.categoryId,subCategoryId:v.subCategoryId,name:v.name,image:A[0].image,price:v.price,amount:o.amount,specificationId:o.specificationId,specificationName:(T=(s=t.find(et=>et.id===o.specificationId))==null?void 0:s.specName)!=null?T:"\u7121"}})),P()):_.value=(c=w.value)!=null?c:[]}nt(async()=>{await g(),await k()});const L=M(()=>_.value.reduce((a,c)=>a+c.amount,0)),q=M(()=>_.value.reduce((a,c)=>a+c.amount*c.price,0)),G={text:"\u7E7C\u7E8C\u8CFC\u7269",color:"match-color",afterTextIcon:ft},J={text:"\u8A02\u55AE\u7D50\u5E33",color:"main-product-color",afterTextIcon:$t},d=$(new Set);function K(a){d.value.add(a)}function Q(a){d.value.delete(a)}function W(){_.value.forEach(a=>{d.value.add(a.id)})}function X(){d.value.clear()}async function Y(){r.value?await Promise.all(Array.from(d.value).map(a=>j({id:a}))):d.value.forEach(a=>{C(a)}),await g(),await k(),d.value.clear(),F()}function Z(){r.value?z.push({name:"checkout"}):z.push({name:"login"})}function S(a,c,o){z.push({name:"product",params:{categoryId:c,subCategoryId:o,productId:a}})}async function tt(a){r.value?await j({id:a}):C(a),await g(),await k(),F()}async function N(a,c){r.value?await zt({id:a,amount:c}):p(a,c),await g(),await k(),F()}return(a,c)=>{const o=pt,v=Ct,A=wt;return i(),u("div",Et,[e("div",Pt,[I(" \u8CFC\u7269\u8ECA "),e("button",{disabled:n(d).size<=0,class:"all-delete-btn",onClick:Y}," \u5168\u90E8\u522A\u9664 ",8,Bt)]),e("div",St,[e("div",Nt,[n(d).size===n(_).length&&n(_).length>0?(i(),u("button",{key:0,onClick:X},[h(o)])):(i(),u("button",{key:1,onClick:W},[h(v)])),I(" \u5168\u90E8\u5546\u54C1 ")]),Tt]),n(L)!==0?(i(),u("div",Vt,[(i(!0),u(it,null,ut(n(_),t=>(i(),u("div",{key:`product-cart-${t.id}`,class:"product"},[e("div",Dt,[n(d).has(t.id)?(i(),u("button",{key:0,onClick:s=>Q(t.id)},[h(o)],8,Mt)):(i(),u("button",{key:1,onClick:s=>K(t.id)},[h(v)],8,Ut))]),e("div",{class:"product-name",onClick:s=>S(t.productId,t.categoryId,t.subCategoryId)},[e("img",{class:"product-img",src:n(H)(t.image),alt:""},null,8,Rt),I(" "+l(t.name),1)],8,Ht),e("div",Ot,l(t.specificationName),1),e("div",jt," NT$ "+l(t.price),1),e("div",qt,[R(e("input",{"onUpdate:modelValue":s=>t.amount=s,type:"number",min:"1",max:"10",onClick:s=>N(t.id,t.amount)},null,8,Gt),[[O,t.amount]])]),e("div",Jt," NT$ "+l(t.amount*t.price),1),e("div",Kt,[e("img",{class:"product-img",src:n(H)(t.image),alt:"",onClick:s=>S(t.productId,t.categoryId,t.subCategoryId)},null,8,Qt),e("div",Wt,[e("div",null,l(t.name),1),e("div",null," \u898F\u683C\uFF1A"+l(t.specificationName),1),e("div",null,"\u55AE\u50F9\uFF1ANT$ "+l(t.price),1),e("div",null,[I(" \u6578\u91CF\uFF1A"),R(e("input",{"onUpdate:modelValue":s=>t.amount=s,type:"number",min:"1",max:"10",onClick:s=>N(t.id,t.amount)},null,8,Xt),[[O,t.amount]])]),e("div",Yt," \u5C0F\u8A08\uFF1ANT$ "+l(t.amount*t.price),1)])]),e("div",Zt,[e("button",{onClick:s=>tt(t.id)},[h(A)],8,te)])]))),128))])):(i(),u("div",ee," \u76EE\u524D\u9084\u6C92\u6709\u5546\u54C1\u5594\uFF01 ")),e("div",ae,[e("div",ce," \u5171 "+l(n(L))+" \u4EF6\u5546\u54C1 | \u7E3D\u8A08 NT$ "+l(n(q)),1),e("div",oe,[h(n(mt),{class:"btn",to:{name:"home"}},{default:dt(()=>[h(U,{content:G})]),_:1}),h(U,{class:"btn",disabled:n(L)===0,content:J,onClick:Z},null,8,["disabled"])])])])}}});const re=vt(se,[["__scopeId","data-v-7a00558d"]]);export{re as default};
