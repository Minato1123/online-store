import{s as _,u as v,l as y,h as L,d as k,j as h,r as f,w as B,o as E,a as F,b as o,f as P,P as b,e as I,B as U,g as m,U as C,V as M,k as x,_ as D}from"./index.2e401dab.js";function S({currentPage:a,pageSize:n,sortBy:d,orderBy:i,userId:r}){const{isMocked:c,mockData:l}=_(v()),{isUserTokenValid:s}=v(),{userToken:p}=_(y()),{forcedLogout:g}=y();if(!c.value)return L.get({url:"/followItems",params:{currentPage:a,pageSize:n,sortBy:d,orderBy:i,userId:r}});if(s(p.value)===!1)return g(),{data:{}};if(l.value==null)return{data:{}};const t=l.value.followItems.filter(e=>e.userId===r);return d==="id"&&(i==="asc"?t.sort((e,w)=>e.id-w.id):i==="desc"&&t.sort((e,w)=>w.id-e.id)),{data:{productList:t.slice(n*(a-1),a*n),pagination:{first:1,prev:a>1?a-1:null,next:a<Math.ceil(t.length/n)?a+1:null,last:Math.ceil(t.length/n)}}}}const V=a=>(C("data-v-7e336aee"),a=a(),M(),a),T={class:"follow-container"},z=V(()=>x("div",{class:"follow-bar"}," \u8FFD\u8E64\u6E05\u55AE ",-1)),A={key:1,class:"empty-follow"},N=k({__name:"Following",setup(a){const{userId:n}=_(y()),{startLoading:d,endLoading:i}=h(),r=f(),c=f(),l=f([]),s=f({currentPage:1,pageSize:6,sortBy:"id",orderBy:"asc",userId:n.value});async function p(){d();const u=(await S(s.value)).data;i(),r.value=u.productList,c.value=u.pagination}async function g(){r.value!=null&&(d(),l.value=await Promise.all(r.value.map(async u=>(await U({id:u.productId})).data)),i())}return B(s,async()=>{await p(),g()},{deep:!0}),E(async()=>{await p(),g()}),(u,t)=>(m(),F("div",T,[z,o(l)!=null&&o(r)!=null?(m(),P(b,{key:0,"current-page":o(s).currentPage,"onUpdate:current-page":t[0]||(t[0]=e=>o(s).currentPage=e),"page-size":o(s).pageSize,"onUpdate:page-size":t[1]||(t[1]=e=>o(s).pageSize=e),"sort-by":o(s).sortBy,"onUpdate:sort-by":t[2]||(t[2]=e=>o(s).sortBy=e),"order-by":o(s).orderBy,"onUpdate:order-by":t[3]||(t[3]=e=>o(s).orderBy=e),"product-list":o(l),"total-num-of-products":10,pagination:o(c),"has-page-attr":!1},null,8,["current-page","page-size","sort-by","order-by","product-list","pagination"])):I("",!0),o(l).length<=0?(m(),F("div",A," \u76EE\u524D\u8FFD\u8E64\u6E05\u55AE\u9084\u6C92\u6709\u5546\u54C1\u5594\uFF01 ")):I("",!0)]))}});const H=D(N,[["__scopeId","data-v-7e336aee"]]);export{H as default};
