import{s as P,u as B,h as I,d as M,c as h,j as O,r as g,w as k,o as x,a as L,b as a,t as T,e as S,f as D,P as N,g as _,i as U,_ as z}from"./index.2e401dab.js";import{g as R}from"./getCategory.d62f7851.js";import{g as j}from"./getSubCategory.0242347d.js";function E({currentPage:r,pageSize:i,subCategoryId:c,sortBy:s,orderBy:n}){const{isMocked:y,mockData:p}=P(B());if(!y.value)return I.get({url:"/products",params:{currentPage:r,pageSize:i,subCategoryId:c,sortBy:s,orderBy:n}});if(p.value==null)return{data:{}};let e=[...p.value.products];return e=e.filter(t=>t.subCategoryId===c),s==="id"?n==="asc"?e.sort((t,o)=>t.id-o.id):n==="desc"&&e.sort((t,o)=>o.id-t.id):s==="name"?n==="asc"?e.sort((t,o)=>t.name.localeCompare(o.name)):n==="desc"&&e.sort((t,o)=>o.name.localeCompare(t.name)):s==="price"&&(n==="asc"?e.sort((t,o)=>t.price-o.price):n==="desc"&&e.sort((t,o)=>o.price-t.price)),{data:{productList:e.slice(i*(r-1),r*i),pagination:{first:1,prev:r>1?r-1:null,next:r<Math.ceil(e.length/i)?r+1:null,last:Math.ceil(e.length/i)}}}}async function V({subCategoryId:r}){const{isMocked:i,mockData:c}=P(B());return i.value?c.value==null?{data:{numOfProducts:0}}:{data:{numOfProducts:[...c.value.products].filter(n=>n.subCategoryId===r).length}}:await I.get({url:"/numOfProducts",params:{subCategoryId:r}})}const q={class:"home-container"},A={key:0,class:"title"},F=M({__name:"SubCategory",setup(r){const i=U(),c=h(()=>i.params.categoryId),s=h(()=>i.params.subCategoryId),{startLoading:n,endLoading:y}=O(),p=g(),e=g(),t=g(),o=g(),f=g(),u=g({currentPage:1,pageSize:6,subCategoryId:+s.value,sortBy:"id",orderBy:"asc"});async function m(){n();const w=(await E(u.value)).data;y(),p.value=w.productList,e.value=w.pagination}async function b(){t.value=(await V({subCategoryId:+s.value})).data.numOfProducts}async function v(){o.value=(await R({id:+c.value})).data}async function C(){f.value=(await j({id:+s.value})).data}return k([c,s],async()=>{u.value.subCategoryId=+s.value,await m(),await v(),await C(),await b(),window.scrollTo({top:0,behavior:"smooth"})}),k(u,async()=>{await m(),await v(),await C(),await b(),window.scrollTo({top:0,behavior:"smooth"})},{deep:!0}),x(()=>{m(),v(),C(),b()}),(w,d)=>(_(),L("div",q,[a(f)!=null?(_(),L("div",A,T(a(f).name),1)):S("",!0),a(p)!=null?(_(),D(N,{key:1,"current-page":a(u).currentPage,"onUpdate:current-page":d[0]||(d[0]=l=>a(u).currentPage=l),"page-size":a(u).pageSize,"onUpdate:page-size":d[1]||(d[1]=l=>a(u).pageSize=l),"sort-by":a(u).sortBy,"onUpdate:sort-by":d[2]||(d[2]=l=>a(u).sortBy=l),"order-by":a(u).orderBy,"onUpdate:order-by":d[3]||(d[3]=l=>a(u).orderBy=l),"link-category-id":+a(c),"link-sub-category-id":+a(s),"product-list":a(p),"total-num-of-products":a(t),pagination:a(e),"has-page-attr":!0},null,8,["current-page","page-size","sort-by","order-by","link-category-id","link-sub-category-id","product-list","total-num-of-products","pagination"])):S("",!0)]))}});const K=z(F,[["__scopeId","data-v-f83cab09"]]);export{K as default};
