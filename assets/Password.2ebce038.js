import{s as g,u as A,l as y,h as U,d as q,r as m,a as E,p as r,q as c,f as w,T as D,z as V,F as N,g as f,k as o,b as l,v as p,K as F,N as x,O as K,a2 as h,Q as I,e as S,I as L,U as M,V as O,J as $,_ as R}from"./index.2e401dab.js";import{P as z}from"./PUserLayout.0d700a5d.js";import{I as J,a as Q}from"./cross-circle.b92b233f.js";function j(t){const{isMocked:i,mockData:d}=g(A()),{isUserTokenValid:C}=A(),{userToken:_}=g(y()),{forcedLogout:b}=y();if(!i.value)return U.patch({url:`users/${t.id}`,data:t});if(C(_.value)===!1){b();return}if(d.value==null)return;const s=d.value.users.find(u=>u.id===t.id);s==null||s.deleted===!0||t.oldPassword&&t.newPassword&&s.password===t.oldPassword&&(s.password=t.newPassword)}const P=t=>(M("data-v-ece33baf"),t=t(),O(),t),G={class:"outer-block"},H={class:"pw-blocks"},W={class:"pw-block"},X=P(()=>o("div",{class:"subtitle"},[$(" \u76EE\u524D\u7684\u5BC6\u78BC "),o("button",{class:"forget-pw-btn"}," \u5FD8\u8A18\u5BC6\u78BC\uFF1F ")],-1)),Y={class:"pw-block"},Z=P(()=>o("div",{class:"subtitle"}," \u65B0\u5BC6\u78BC ",-1)),ee={class:"pw-block"},oe=P(()=>o("div",{class:"subtitle"}," \u78BA\u8A8D\u65B0\u5BC6\u78BC ",-1)),se={class:"save-btn-block"},te=q({__name:"Password",setup(t){const i=m(!1),d=m(!0),{userId:C}=g(y()),_={text:"\u5132\u5B58",color:"main-color"},b={iconBeforeText:J,text:"\u5132\u5B58\u6210\u529F\uFF01",color:"main-color",borderColor:"main-color",textInBtnOK:{text:"\u78BA\u5B9A",color:"match-color"}},k={iconBeforeText:Q,text:"\u5132\u5B58\u5931\u6557\uFF01",additionalText:"\u8ACB\u7A0D\u5F8C\u518D\u8A66\u4E00\u6B21",color:"main-product-color",borderColor:"main-product-color",textInBtnOK:{text:"\u78BA\u5B9A",color:"main-product-color"}},s=m(""),u=m(""),n=m("");async function T(){if(i.value=!0,u.value!==n.value){d.value=!1;return}await j({id:C.value,oldPassword:s.value,newPassword:u.value}),d.value=!0,s.value="",u.value="",n.value=""}return(ue,e)=>{const B=L("FormKit");return f(),E(N,null,[r(z,null,{default:c(()=>[r(B,{"form-class":"$reset",type:"form",actions:!1,"incomplete-message":" ",onSubmit:T,onSubmitInvalid:e[7]||(e[7]=()=>{})},{default:c(()=>[o("form",{class:"pw-container",onSubmit:e[6]||(e[6]=h(()=>{},["prevent"]))},[o("div",G,[o("div",H,[r(B,{modelValue:l(s),"onUpdate:modelValue":e[1]||(e[1]=a=>p(s)?s.value=a:null),type:"password",validation:"required:trim|length:8","validation-visibility":"live","validation-messages":{required:"\u8ACB\u8F38\u5165\u73FE\u5728\u7684\u5BC6\u78BC",length:"\u8ACB\u8F38\u5165\u81F3\u5C11 8 \u500B\u5B57\u5143"}},{wrapper:c(a=>[o("div",W,[X,F(o("input",{"onUpdate:modelValue":e[0]||(e[0]=v=>p(s)?s.value=v:null),type:"password",autocomplete:"off"},null,512),[[x,l(s)]])])]),_:1},8,["modelValue"]),r(B,{modelValue:l(u),"onUpdate:modelValue":e[3]||(e[3]=a=>p(u)?u.value=a:null),type:"password",name:"newPassword",validation:"required:trim|length:8","validation-visibility":"live","validation-messages":{required:"\u8ACB\u8F38\u5165\u65B0\u7684\u5BC6\u78BC",length:"\u8ACB\u8F38\u5165\u81F3\u5C11 8 \u500B\u5B57\u5143"}},{wrapper:c(a=>[o("div",Y,[Z,F(o("input",{"onUpdate:modelValue":e[2]||(e[2]=v=>p(u)?u.value=v:null),type:"password",autocomplete:"off"},null,512),[[x,l(u)]])])]),_:1},8,["modelValue"]),r(B,{modelValue:l(n),"onUpdate:modelValue":e[5]||(e[5]=a=>p(n)?n.value=a:null),type:"password",name:"newPassword_confirm",validation:"required|confirm","validation-visibility":"live","validation-messages":{required:"\u8ACB\u8F38\u5165\u65B0\u7684\u5BC6\u78BC",confirm:"\u65B0\u5BC6\u78BC\u4E0D\u76F8\u540C\uFF0C\u8ACB\u518D\u6B21\u78BA\u8A8D"}},{wrapper:c(a=>[o("div",ee,[oe,F(o("input",{"onUpdate:modelValue":e[4]||(e[4]=v=>p(n)?n.value=v:null),type:"password",autocomplete:"off"},null,512),[[x,l(n)]])])]),_:1},8,["modelValue"])])]),o("div",se,[r(K,{class:"save-btn",content:_,type:"submit"})])],32)]),_:1})]),_:1}),(f(),w(V,{to:"body"},[r(D,null,{default:c(()=>[l(i)&&l(d)?(f(),w(I,{key:0,"text-in-dialog":b,onCloseInfoDialog:e[8]||(e[8]=a=>i.value=!1)})):S("",!0)]),_:1})])),(f(),w(V,{to:"body"},[r(D,null,{default:c(()=>[l(i)&&!l(d)?(f(),w(I,{key:0,"text-in-dialog":k,onCloseInfoDialog:e[9]||(e[9]=a=>i.value=!1)})):S("",!0)]),_:1})]))],64)}}});const re=R(te,[["__scopeId","data-v-ece33baf"]]);export{re as default};
