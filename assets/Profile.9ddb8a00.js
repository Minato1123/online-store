import{s as h,u as S,l as b,h as E,d as z,j as H,r as x,o as J,c as Q,f as d,q as p,a5 as G,g as u,k as l,b as e,K as k,N as g,a as C,e as c,p as D,J as W,O as X,z as T,Q as U,T as L,a2 as Y,H as Z,U as ee,V as te,_ as oe}from"./index.2e401dab.js";import{P as se}from"./PUserLayout.0d700a5d.js";import{I as P,a as w}from"./cross-circle.b92b233f.js";function ue(t){const{isMocked:f,mockData:m}=h(S()),{isUserTokenValid:B}=S(),{userToken:y}=h(b()),{forcedLogout:_}=b();if(!f.value)return E.patch({url:`/users/${t.id}`,data:t});if(B(y.value)===!1){_();return}if(m.value==null)return;const n=m.value.users.find(r=>r.id===t.id);n==null||n.deleted===!0||t.name==null||t.email==null||t.birthday==null||t.mobile==null||t.address==null||(n.name=t.name,n.email=t.email,n.birthday=t.birthday,n.mobile=t.mobile,n.address=t.address)}function le({id:t}){const{isMocked:f,mockData:m}=h(S()),{isUserTokenValid:B}=S(),{userToken:y}=h(b()),{forcedLogout:_}=b();if(!f.value)return E.delete({url:`/users/${t}`});if(B(y.value)===!1){_();return}if(m.value==null)return;const n=m.value.users.find(r=>r.id===t);n&&(n.deleted=!0)}const F=t=>(ee("data-v-a1429450"),t=t(),te(),t),ne={class:"name-birthday-container"},ae={class:"name-block"},re=F(()=>l("div",{class:"sub-title"}," \u59D3\u540D ",-1)),ie={class:"birthday-block"},de=F(()=>l("div",{class:"sub-title"}," \u751F\u65E5 ",-1)),ce={class:"email-block"},fe=F(()=>l("div",{class:"sub-title"}," \u96FB\u5B50\u4FE1\u7BB1 ",-1)),me={class:"tel-block"},ve=F(()=>l("div",{class:"sub-title"}," \u624B\u6A5F\u865F\u78BC ",-1)),pe={class:"address-block"},be=F(()=>l("div",{class:"sub-title"}," \u9001\u4EF6\u5730\u5740 ",-1)),Be={class:"save-button"},ye=z({__name:"Profile",setup(t){const{userId:f,isLoggedIn:m}=h(b()),{forcedLogout:B}=b(),{startLoading:y,endLoading:_}=H(),i=x();async function n(){!m.value||(y(),i.value=(await G({id:f.value})).data,_())}J(()=>{n()});const r=x(!1),v=x(!1),I=x(!0),A=x(!0),s=Q(()=>{if(i.value!=null)return{name:i.value.name,birthday:i.value.birthday,email:i.value.email,mobile:i.value.mobile,address:i.value.address}});async function O(){if(s.value!=null){try{await ue({id:f.value,...s.value})}catch{I.value=!1,r.value=!0;return}I.value=!0,r.value=!0}}async function M(){try{await le({id:f.value})}catch{A.value=!1,v.value=!0;return}A.value=!0,v.value=!0}function K(){v.value=!1,B(),Z.replace({name:"home"})}const N={text:"\u5132\u5B58",color:"main-color"},$={iconBeforeText:P,text:"\u5132\u5B58\u6210\u529F\uFF01",color:"main-color",borderColor:"main-color",textInBtnOK:{text:"\u78BA\u5B9A",color:"match-color"}},R={iconBeforeText:w,text:"\u5132\u5B58\u5931\u6557\uFF01",additionalText:"\u8ACB\u7A0D\u5F8C\u518D\u8A66\u4E00\u6B21",color:"main-product-color",borderColor:"main-product-color",textInBtnOK:{text:"\u78BA\u5B9A",color:"main-product-color"}},j={iconBeforeText:P,text:"\u522A\u9664\u6210\u529F\uFF01",color:"main-color",borderColor:"main-color",textInBtnOK:{text:"\u78BA\u5B9A",color:"match-color"}},q={iconBeforeText:w,text:"\u522A\u9664\u5931\u6557\uFF01",additionalText:"\u8ACB\u7A0D\u5F8C\u518D\u8A66\u4E00\u6B21",color:"main-product-color",borderColor:"main-product-color",textInBtnOK:{text:"\u78BA\u5B9A",color:"main-product-color"}};return(V,o)=>(u(),d(se,null,{default:p(()=>[l("form",{class:"profile-container",onSubmit:o[8]||(o[8]=Y(()=>{},["prevent"]))},[l("div",ne,[l("div",ae,[re,e(s)?k((u(),C("input",{key:0,"onUpdate:modelValue":o[0]||(o[0]=a=>e(s).name=a),type:"text",class:"name-input"},null,512)),[[g,e(s).name]]):c("",!0)]),l("div",ie,[de,e(s)?k((u(),C("input",{key:0,"onUpdate:modelValue":o[1]||(o[1]=a=>e(s).birthday=a),type:"date",class:"birthday-input"},null,512)),[[g,e(s).birthday]]):c("",!0)])]),l("div",ce,[fe,e(s)?k((u(),C("input",{key:0,"onUpdate:modelValue":o[2]||(o[2]=a=>e(s).email=a),type:"email"},null,512)),[[g,e(s).email]]):c("",!0)]),l("div",me,[ve,e(s)?k((u(),C("input",{key:0,"onUpdate:modelValue":o[3]||(o[3]=a=>e(s).mobile=a),type:"tel"},null,512)),[[g,e(s).mobile]]):c("",!0)]),l("div",pe,[be,e(s)?k((u(),C("input",{key:0,"onUpdate:modelValue":o[4]||(o[4]=a=>e(s).address=a),type:"text"},null,512)),[[g,e(s).address]]):c("",!0)]),l("div",Be,[D(X,{class:"save-btn",content:N,onClick:O},{default:p(()=>[W(" \u5132\u5B58 ")]),_:1}),l("button",{class:"delete-btn",onClick:M}," \u522A\u9664\u5E33\u865F ")]),(u(),d(T,{to:"body"},[D(L,null,{default:p(()=>[e(r)&&e(I)?(u(),d(U,{key:0,"text-in-dialog":$,onCloseInfoDialog:o[5]||(o[5]=a=>r.value=!1)})):c("",!0)]),_:1})])),(u(),d(T,{to:"body"},[D(L,null,{default:p(()=>[e(r)&&!e(I)?(u(),d(U,{key:0,"text-in-dialog":R,onCloseInfoDialog:o[6]||(o[6]=a=>r.value=!1)})):c("",!0)]),_:1})])),(u(),d(T,{to:"body"},[D(L,null,{default:p(()=>[e(v)&&e(A)?(u(),d(U,{key:0,"text-in-dialog":j,onCloseInfoDialog:K})):c("",!0)]),_:1})])),(u(),d(T,{to:"body"},[D(L,null,{default:p(()=>[e(v)&&!e(A)?(u(),d(U,{key:0,"text-in-dialog":q,onCloseInfoDialog:o[7]||(o[7]=a=>v.value=!1)})):c("",!0)]),_:1})]))],32)]),_:1}))}});const ge=oe(ye,[["__scopeId","data-v-a1429450"]]);export{ge as default};
