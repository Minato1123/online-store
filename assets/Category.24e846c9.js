import{s as w,u as h,h as k,d as P,c as b,r as p,w as v,o as L,a as _,b as o,t as B,e as C,f as M,P as O,g as m,i as I,_ as x}from"./index.2e401dab.js";import{g as T}from"./getCategory.d62f7851.js";function D({currentPage:n,pageSize:c,categoryId:s,sortBy:i,orderBy:r}){const{isMocked:f,mockData:d}=w(h());if(!f.value)return k.get({url:"/products",params:{currentPage:n,pageSize:c,categoryId:s,sortBy:i,orderBy:r}});if(d.value==null)return{data:{}};let t=[...d.value.products];return t=t.filter(a=>a.categoryId===s),i==="id"?r==="asc"?t.sort((a,e)=>a.id-e.id):r==="desc"&&t.sort((a,e)=>e.id-a.id):i==="name"?r==="asc"?t.sort((a,e)=>a.name.localeCompare(e.name)):r==="desc"&&t.sort((a,e)=>e.name.localeCompare(a.name)):i==="price"&&(r==="asc"?t.sort((a,e)=>a.price-e.price):r==="desc"&&t.sort((a,e)=>e.price-a.price)),{data:{productList:t.slice(c*(n-1),n*c),pagination:{first:1,prev:n>1?n-1:null,next:n<Math.ceil(t.length/c)?n+1:null,last:Math.ceil(t.length/c)}}}}async function N({categoryId:n}){const{isMocked:c,mockData:s}=w(h());return c.value?s.value==null?{data:{numOfProducts:0}}:{data:{numOfProducts:[...s.value.products].filter(r=>r.categoryId===n).length}}:await k.get({url:"/numOfProducts",params:{categoryId:n}})}const U={class:"home-container"},z={key:0,class:"title"},R=P({__name:"Category",setup(n){const c=I(),s=b(()=>c.params.categoryId),i=p(),r=p(),f=p(),d=p(),t=p({currentPage:1,pageSize:6,categoryId:+s.value,sortBy:"id",orderBy:"asc"});async function a(){const g=(await D(t.value)).data;i.value=g.productList,r.value=g.pagination}async function e(){f.value=(await N({categoryId:+s.value})).data.numOfProducts}async function y(){d.value=(await T({id:+s.value})).data}return v(s,async()=>{t.value.categoryId=+s.value,await a(),await y(),await e(),window.scrollTo({top:0,behavior:"smooth"})}),v(t,async()=>{await a(),await y(),await e(),window.scrollTo({top:0,behavior:"smooth"})},{deep:!0}),L(()=>{a(),y(),e()}),(g,u)=>(m(),_("div",U,[o(d)!=null?(m(),_("div",z,B(o(d).name),1)):C("",!0),o(i)!=null?(m(),M(O,{key:1,"current-page":o(t).currentPage,"onUpdate:current-page":u[0]||(u[0]=l=>o(t).currentPage=l),"page-size":o(t).pageSize,"onUpdate:page-size":u[1]||(u[1]=l=>o(t).pageSize=l),"sort-by":o(t).sortBy,"onUpdate:sort-by":u[2]||(u[2]=l=>o(t).sortBy=l),"order-by":o(t).orderBy,"onUpdate:order-by":u[3]||(u[3]=l=>o(t).orderBy=l),"link-category-id":+o(s),"product-list":o(i),"total-num-of-products":o(f),pagination:o(r),"has-page-attr":!0},null,8,["current-page","page-size","sort-by","order-by","link-category-id","product-list","total-num-of-products","pagination"])):C("",!0)]))}});const V=x(R,[["__scopeId","data-v-cdac2689"]]);export{V as default};
